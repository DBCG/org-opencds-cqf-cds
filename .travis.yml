language: java
jdk: openjdk11
os: linux
dist: xenial
cache:
  timeout: 180
  directories:
  - "$HOME/.m2/repository"
install:
- mvn install -U -DskipTests=true -Dmaven.javadoc.skip=true -B -V
script:
- if [[ "$TRAVIS_BRANCH" =~ master* ]]; then mvn test -B -P release; fi
- if ! [[ "$TRAVIS_BRANCH" =~ master* ]]; then mvn test -B; fi
before_deploy:
- if [[ "$TRAVIS_BRANCH" =~ master* ]]; then echo $GPG_SECRET_KEYS | base64 --decode
  | $GPG_EXECUTABLE --import; fi
- if [[ "$TRAVIS_BRANCH" =~ master* ]]; then echo $GPG_OWNERTRUST | base64 --decode
  | $GPG_EXECUTABLE --import-ownertrust; fi
deploy:
- provider: script
  script: cp .travis.settings.xml $HOME/.m2/settings.xml && mvn deploy -DskipTests=true
  cleanup: false
  skip_cleanup: true
  on:
    branch: develop
- provider: script
  script: cp .travis.settings.xml $HOME/.m2/settings.xml && mvn deploy -P release
    -DskipTests=true
  cleanup: false
  skip_cleanup: true
  on:
    branch: master
before_cache:
- rm -rf $HOME/.m2/repository/org/opencds/cqf/cds
notifications:
  slack:
    rooms:
      secure: i7QAWlakVmBpgtZIw+ecBt7anXG9Fdang1g/CfPT6PAD+SIk3GXxWHWrBRvicIziZT9waTgzg9uzcXe8BKxpNN13jORKWx7Y5UWWdG/rf+WcGJDsnVagt4E/S9DxUyzjR8AbFq9+jpbVYGusZLWrHynUaQE3EyPLkz6WCPROtuwuscaeBYlFh06wJg6TJu6G3rbj7anlZ3L1vT/8bbfJKEH3gW/0M8hbR8IJavQZnnptRHlfcWNjrdFDL4a4vrL5R+S+WgwZCvvaFWg6PeQbV1vlKnQ36DycDr2Z38OQxbNFoqu4pljQNvnPEo6tuRptzL3jjLluP+UjaGdLotLMzGCoXiB6DtaY2GnCqUXI5kHHTxuLnwFi58RSGZuHlTr9nUcftvA3JnlB0SjoEz6CKStJVksH/oKvExmPeAOOlN7AuqOtxXODqxS217Yro+DMjt3m5LO+PLHBE2XuWJSYUWcOnEEs6pMbeZvcpEiD3DmUC7QeErV8uay5LBIIkjgDRe0uQhpnOTDpbrSY1dU5rFGC4CNNPDwWHu3ysDjna/QYYkrG14Xi/FDlkRsBU4oYhh5+HqhBtMRTJ16a9ueX7LwgPxiZxtA7rJOG4Wic2huzW96tM2tFOkn85/IE19q2sbfzWj9dlJNA17nFKRav8RTYizPBsH39dSHHAcqm7g4=
